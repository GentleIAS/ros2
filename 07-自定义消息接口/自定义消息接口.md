# 构建消息接口包
消息接口只能通过c++构建
```python
ros2 pkg create --build-type ament_cmake message_interface --dependencies builtin_interfaces rosidl_generators
```
两个依赖`builtin_interfaces rosidl_generators`
```python
builtin_interfaces

- 这是ROS2的内置接口包，提供了基础的消息类型
- 包含常用的数据类型如： Time 、 Duration 、 Header 等
- 在你的SystemStatus.msg中使用的 builtin_interfaces/Time stamp 就来自这个包
- 几乎所有ROS2项目都会依赖这个包


rosidl_generators

- 这是ROS2接口定义语言(ROSIDL)的代码生成器
- 负责将.msg、.srv、.action文件转换为各种编程语言的代码
- 支持C++、Python、JavaScript等多种语言的代码生成
- 在你的package.xml中作为依赖项存在
```
# 消息接口规定
## 文件命名规定
```python
1.消息文件必须以 .msg 扩展名结尾
2.文件名应使用PascalCase命名法（如 SystemStatus.msg ）
3.文件必须放在包的 msg/ 目录下
```
## 数据类型规范
```python
基本数据类型：
1.布尔值：bool
2.有符号整数：int8 , int16 , int32 , int64
3.无符号整数：uint8 , uint16 , uint32 , uint64
4.浮点数：float32 , float64（注意：不能使用 float ）
5.字符串：string
6.宽字符串：wstring

时间类型：
1.时间戳：builtin_interfaces/Time
2.时间间隔：builtin_interfaces/Duration
```
## 语法规范
```python
1.每行定义一个字段： 数据类型 字段名 #注释
2.字段名使用snake_case命名法
3.支持数组： int32[] numbers 或 int32[5] fixed_array
4.支持常量： int32 MAX_SIZE=100
5.支持默认值： string name "default_name"
```
# 代码
## `SystemStatus.msg`
```python
builtin_interfaces/Time stamp    #记录时间戳
string host_name                 #主机名字
float32 cpu_percent              #CPU使用率
float32 memory_percent           #内存使用率
float32 memory_total             #内存总大小
float32 memory_available         #剩余内存大小
float64 net_sent                 #网络发送数据总量 MB(1MB=8Mb)
float64 net_recv                 #网络数据接受总量 MB
```
## `CMakeLists.txt`
```clike
cmake_minimum_required(VERSION 3.8)
project(message_interface)

if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")
  add_compile_options(-Wall -Wextra -Wpedantic)
endif()

# find dependencies
find_package(ament_cmake REQUIRED)
find_package(builtin_interfaces REQUIRED)
find_package(rosidl_default_generators REQUIRED)

rosidl_generate_interfaces(${PROJECT_NAME}
  "msg/SystemStatus.msg"
  DEPENDENCIES builtin_interfaces
)

if(BUILD_TESTING)
  find_package(ament_lint_auto REQUIRED)
  # the following line skips the linter which checks for copyrights
  # comment the line when a copyright and license is added to all source files
  set(ament_cmake_copyright_FOUND TRUE)
  # the following line skips cpplint (only works in a git repo)
  # comment the line when this package is in a git repo and when
  # a copyright and license is added to all source files
  set(ament_cmake_cpplint_FOUND TRUE)
  ament_lint_auto_find_test_dependencies()
endif()

ament_package()
```
### `rosidl_generate_interfaces`函数
```clike
功能作用
1.将 .msg 、 .srv 、 .action 文件转换为各种编程语言的代码
2.自动生成C++、Python、JavaScript等语言的接口类
3.处理消息序列化和反序列化
4.生成类型支持代码和元数据

rosidl_generate_interfaces(包名
  "msg/消息文件.msg"
  "srv/服务文件.srv"
  "action/动作文件.action"
  DEPENDENCIES 依赖包名
)
```
## `package.xml`
在`package.xml`中添加`<member_of_group>rosidl_interface_packages</member_of_group>`