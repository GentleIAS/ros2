# 面向对象编程
面向对象编程是一种编程范式，它将数据和操作数据的方法组织在一起，
形成"对象"，通过对象之间的交互来完成程序功能。

核心概念：
- 1.类（Class）：对象的模板或蓝图
- 2.对象（Object）：类的实例
- 3.属性（Attribute）：对象的数据
- 4.方法（Method）：对象的行为

面向对象的三大特性：
- 1.封装（Encapsulation）：将数据和方法包装在一起
- 2.继承（Inheritance）：子类继承父类的属性和方法
- 3.多态（Polymorphism）：同一接口的不同实现

# Python
[Python面向对象](https://github.com/GentleIAS/python/blob/main/10-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B.md)
`person_node.py`
```python
class PersonNode:    #创建类（首字母大写）
    def __init__(self,name:str,age:int) -> None:    #定义init方法（在创建类的时候调用）
        print("__init__方法被调用")
        self.name = name    #self：类本身
        self.age = age

    def eat(self,food_name:str):    #类的方法，第一个变量必须是self
        """
        说明：
        方法：吃东西
        food_name：实物名字
        """
        print(f"{self.name}，{self.age}岁，爱吃{food_name}")    #f：格式化
        
def main():
    node = PersonNode('法外狂徒张三',18)    #创建类实例
    node.eat('鱼香肉丝')
```
输出：
```python
__init__方法被调用
法外狂徒张三，18岁，爱吃鱼香肉丝
```
`writer_node.py`
```python
from python_package.person_node import PersonNode    #导入python_package文件夹下的person_node的PersonNode类

class WriterNode(PersonNode):
    #name无传入时默认“匿名作者”，age：18，write：没有作品
    def __init__(self,name:str = '匿名作者',age:int = 18,write:str = '没有作品') -> None:
        self.write = write
        super().__init__(name,age)

    def eat(self,food_name:str):    #重写eat方法
        """
        说明：
        方法：吃东西
        food_name：实物名字
        """
        print(f"{self.name}，{self.age}岁，爱吃：{food_name}，书籍：{self.write}")

def main():
    node1 = WriterNode(name = '村民李四',age = 35)
    node2 = WriterNode(write = '在ros2速成python')
    node1.eat('香蕉')
    node2.eat('苹果')
```
输出：
```python
__init__方法被调用
__init__方法被调用
匿名作者，18岁，爱吃：香蕉，书籍：在ros2速成python
村民李四，35岁，爱吃：苹果，书籍：没有作品
```
# C++
`cpp_person_node.h`
```cpp
#ifndef CPP_PERSON_NODE_H
#define CPP_PERSON_NODE_H

#include "rclcpp/rclcpp.hpp"
class PersonNode:public rclcpp::Node   //创建类PersonNode继承rclcpp的Node类
{
private:    //私有的
    std::string name_;
    int age_;

public:    //公有的
    //创建PersonNode的构造函数（与类名相同）并调用父级的构造函数
    PersonNode(const std::string &node_name,const std::string &name,const int &age):Node(node_name)
    {
        this->name_ = name;
        this->age_ = age;
    };

    void eat(const std::string &food_name)
    {
        //调用父级的日志打印，.c_str()是将string类型转换成c语言的char *类型
        RCLCPP_INFO(this->get_logger(),"%s，%d岁，爱吃：%s",this->name_.c_str(),this->age_,food_name.c_str());
    };

    std::string get_name()
    {
        return this->name_;
    };

    int get_age()
    {
        return this->age_;
    };
};

#endif
```
`cpp_person_node.cpp`
```cpp
#include "rclcpp/rclcpp.hpp"
#include "cpp_person_node.h"

int main(int argc,char** argv)
{
    rclcpp::init(argc,argv);
    auto node = std::make_shared<PersonNode>("cpp_person_node","法外狂徒张三",18);
    node->eat("鱼香肉丝");
    rclcpp::spin(node);
    rclcpp::shutdown();
    return 0;
};
```
在`CMakeLists.txt`中添加节点后

构建并运行输出：
```bash
sun@sun78698:~/ros2/workspace$ colcon build
Starting >>> cpp_package
Starting >>> python_package
Finished <<< python_package [0.68s]                                                     
Finished <<< cpp_package [2.53s]                     

Summary: 2 packages finished [2.99s]
sun@sun78698:~/ros2/workspace$ ros2 run cpp_package cpp_person_node 
[INFO] [1755566808.339357873] [cpp_person_node]: 法外狂徒张三，18岁，爱吃：鱼香肉丝
^C[INFO] [1755566826.385555750] [rclcpp]: signal_handler(signum=2)
sun@sun78698:~/ros2/workspace$ 
```
`cpp_writer_node.cpp`
```cpp
#include "rclcpp/rclcpp.hpp"
#include "cpp_person_node.h"

class WriterNode : public PersonNode // 创建类PersonNode继承rclcpp的Node类
{
private: // 私有的
    std::string write_;

public: // 公有的
    // 创建PersonNode的构造函数（与类名相同）并调用父级的构造函数
    WriterNode(const std::string &node_name, const std::string &name,const int &age,const std::string &write = "没有作品")
                : PersonNode(node_name, name.empty()?"匿名作者":name, age==0?18:age)
    {
        this->write_ = write;
    };

    void eat(const std::string &food_name)
    {
        // 调用父级的日志打印，.c_str()是将string类型转换成c语言的char *类型
        RCLCPP_INFO(this->get_logger(), "%s，%d岁，爱吃：%s，书籍：%s",this->get_name().c_str(), this->get_age(),
                    food_name.c_str(), this->write_.c_str());
    };
};

int main(int argc, char **argv)
{
    rclcpp::init(argc, argv);
    auto node1 = std::make_shared<WriterNode>("cpp_writer_node1","村民李四",35);
    auto node2 = std::make_shared<WriterNode>("cpp_writer_node2","",0,"在ros2速成C++");
    node1->eat("香蕉");
    node2->eat("苹果");
    rclcpp::spin(node1);
    rclcpp::spin(node2);
    rclcpp::shutdown();
    return 0;
};
```
在`CMakeLists.txt`中添加节点后

构建并运行输出：

```cpp
sun@sun78698:~/ros2/workspace$ colcon build
Starting >>> cpp_package
Starting >>> python_package
Finished <<< python_package [0.66s]                                                     
Finished <<< cpp_package [2.41s]                     

Summary: 2 packages finished [2.93s]
sun@sun78698:~/ros2/workspace$ ros2 run cpp_package cpp_writer_node 
[INFO] [1755575250.877695399] [cpp_writer_node1]: 村民李四，35岁，爱吃：香蕉，书籍：没有作品
[INFO] [1755575250.877803643] [cpp_writer_node2]: 匿名作者，18岁，爱吃：苹果，书籍：在ros2速成C++
^C[INFO] [1755575460.648071146] [rclcpp]: signal_handler(signum=2)
terminate called after throwing an instance of 'rclcpp::exceptions::RCLError'
  what():  failed to create guard condition: the given context is not valid, either rcl_init() was not called or rcl_shutdown() was called., at ./src/rcl/guard_condition.c:67
[ros2run]: Aborted
sun@sun78698:~/ros2/workspace$ 
```